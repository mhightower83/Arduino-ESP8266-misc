#
# Local platform.txt values
#
# Added this so I can tell one build from the other
# It appears to override the one in platform.txt
# name=ESP8266 Modules - 2.5.0 dev

# Copy pasted this from platform.txt for reference.
## These can be overridden in platform.local.txt
# compiler.c.extra_flags=
# compiler.c.elf.extra_flags=
# compiler.S.extra_flags=
# compiler.cpp.extra_flags=
# compiler.ar.extra_flags=
# compiler.objcopy.eep.extra_flags=
# compiler.elf2hex.extra_flags=

# Added these to boards.local.txt
build.my_project_flags=
build.espurna_flags=
build.espurna_ha_flags=
build.my_project_name=



#--------------- Delete Starts Here ---------------
recipe.hooks.prebuild.01.pattern=echo You need to edit "platform.local.txt" and replace "**YourUserId**" with your user id.
#--------------- Delete Stops Here ----------------
#
#                    Attention!
#
# Delete the above lines and do edits below. Replace **YourUserId** below
# with a value that will result in custom.globals_h.path pointing to your
# Sketchbook's Arduino/include directory. This would usually be the same
# as your Login UserID. If you are not using default file locations, make
# other updates as need.

custom.userid=**YourUserId**



custom.globals_h.path.linux=/home/{custom.userid}/Arduino/include
custom.globals_h.path.windows=C:\Users\{custom.userid}\Documents\Arduino\include


compiler.c.extra_flags=-include "{custom.globals_h.path}/ide_globals.h" -include "{build.path}/sketch/globals.h" {build.espurna_flags} {build.espurna_ha_flags} {build.my_project_flags} {build.my_project_name}
compiler.S.extra_flags=-include "{custom.globals_h.path}/ide_globals.h" -include "{build.path}/sketch/globals.h" {build.espurna_flags} {build.espurna_ha_flags} {build.my_project_flags} {build.my_project_name}
compiler.cpp.extra_flags=-include "{custom.globals_h.path}/ide_globals.h" -include "{build.path}/sketch/globals.h" {build.espurna_flags} {build.espurna_ha_flags} {build.my_project_flags} {build.my_project_name}


#
# We create a sketch/globals.h default file in the build tree.
# If the sketch already has a globals.h file, the build process will copy
# over the default file.
# Note at least for Windows 7, the space after the redirect symbol and
# the space before the closing parenthesis are needed.
recipe.hooks.prebuild.02.pattern.windows=cmd /c if not exist "{build.path}\sketch" (mkdir "{build.path}\sketch" )
recipe.hooks.prebuild.03.pattern.windows=cmd /c if not exist "{build.path}\sketch\globals.h" (copy "{custom.globals_h.path}\globals.h" "{build.path}\sketch\globals.h" )
recipe.hooks.prebuild.02.pattern.linux=mkdir -p "{build.path}/sketch"
recipe.hooks.prebuild.03.pattern.linux=cp -n --preserve=timestamps "{custom.globals_h.path}/globals.h" "{build.path}/sketch/globals.h"


#
# This will print a summary report of sizes on some interesting sections.
# For this to show, you need to check the box for "compilation" on the line
# containing: "Show verbose output during: [] compilation [] upload"
# in "Edit->File->Preferences".
tools.elfsum.cmd=xtensa-lx106-elf-objdump
tools.elfsum.path.linux={runtime.tools.xtensa-lx106-elf-gcc.path}/bin/
tools.elfsum.path.windows={runtime.tools.xtensa-lx106-elf-gcc.path}\bin\
tools.elfsum.flags=-h -w --section=.text --section=.irom0.text --section=.data --section=.bss --section=.rodata
tools.elfsum.extra_flags=
recipe.hooks.linking.postlink.01.pattern.linux="{tools.elfsum.path}{tools.elfsum.cmd}" {tools.elfsum.flags} {tools.elfsum.extra_flags} "{build.path}/{build.project_name}.elf"
recipe.hooks.linking.postlink.01.pattern.windows="{tools.elfsum.path}{tools.elfsum.cmd}" {tools.elfsum.flags} {tools.elfsum.extra_flags} "{build.path}\{build.project_name}.elf"


#
# This will write a .map file in the build directory.
compiler.c.elf.extra_flags.linux=-Wl,-Map,{build.path}/{build.project_name}.map
compiler.c.elf.extra_flags.windows=-Wl,-Map,{build.path}\{build.project_name}.map


#
# Contains inspirations from :
# https://github.com/arduino/arduino-builder/issues/15
# https://forum.pjrc.com/threads/38533-HOWTO-Store-Projects-settings-(like-F_CPU-USB-Keyboard-layout)?p=172835&viewfull=1#post172835
